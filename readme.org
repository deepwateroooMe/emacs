
#+latex_class: cn-article
#+title: Emacs Configuration
#+author: deepwaterooo

* Updates 
- clean ARM M Emacs with pyim librime.dylib build capability. Great to have all convenient features enabled. 【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
** configuration for org-mode beamer for slides
- using older version of org-mode because the 2 shorter lines of "#+BEGIN_SRC" AND "#+END_SRC". DO NOT like newer version two long window width lines.
- Beamer configuration under older version, I have NOT configued themes for beamer yet, but inline imgs and source code works, basically satisified my usage cases. If I have to configue for new versions, will do when I have time. 
- *【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】*
** configuration for pdf-tools packages

   [[./pic/mememe2.png]]
- pdf viewer noter <==> Skim bi-directional linking configuration on the way, most emacs work is done. Need to learn how to use them though. 

[[./pic/Snipaste_2023-02-11_20-57-40.png]]
- It has to be configured for M1. But I am still not getting any .tar file yet. 

  [[./pic/Snipaste_2023-02-11_22-20-25.png]]
- could customer F5 toggle sr-speedbar, and make sis-mode work. But I do NOT really need sis-mode, only needed macism command line. to help [LOVE MY DEAR COUSIN!!!]

[[./pic/readme_20230210_221127.png]]
- finally sync up with csharp-mode with tree-sitter, and fixed added the other's that gio-mode etc. 
- Permanently diabled speedbar-edit-file's set-timer function call from Resource files. Do NOT want to see such a bug, don't know how to fix, but disable it and walk around. 
- Now have a relatively barable and stable colorful emacs code editor now, at least for csharp-mode. Relatively satisfied now. Could sit it aside for a while now to focus on projects.
** C/C++ 语言开发环境配置 
- 太久没有用这个了，必须把 emacs 里这个开发的环境配置好。现在用那个什么 init-cc-mode.el
- {|} 的自动扩展开来，我以前不知道怎么回事， java 与 csharp-mode 只能配置好两个中的一个；现在 java 与 csharp-mode 与 cc-mode 似乎都能自动扩展。当初是怎么回事呢？等改天用多了看它还会不会再抛锚抛错。。。先把自己其它 mode 里【中英文】切换注释等常用功能銉转到这个 mode 里来，没问题。这些简单功能都容易实现。
** emacs 1 initiliation bug
- TODO: 需要将Rime 动态库构建成适配配置到 arm64-arch 版本。它性能我电脑的整体性能。
** Emacs arm64-arch, and System Rime input method: *【TODO: 现在应该可以系统更新了！！】* Rime 自己建不出来。。但是活宝妹将来还是会能够建得出来的。【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
- 现在Rime ARM M 版本，我还建不出来，仅只输入法仍为旧版本，其它全是ARM M 的了。
- Emacs 29.1 狠干净：以前 srspeedbar 里Timer 相关的【BUG：】全部改掉了(timer 的【BUG：】还在！！再改一遍)；也没有再占用活宝妹特爱的C-;expand-region 键。就是怪异的中文字体看不习惯，还不知道从哪里来改。【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
- 但是emacs ARM M 版本的， *【全部ARM M 版本的】* ：它们都少了活宝妹也狠喜欢的：Macbook 上触屏翻屏功能。。。那个功能也是活宝妹的大爱。。。【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
- 为了回复活宝妹先前 emacs 里的触屏翻屏功能，把 emacs 29.1 卸载掉，重新安装回 28.2  ARM M 版本，简单试一下，不行就再装回 29.1. 【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】29.1 存在字体怪异的问题； ARM M 28.2 没有怪异字体的这个问题。但是活宝妹心爱的触屏翻屏功能，看似ARM M 版本里，全部被消灭掉了。。。 *活宝妹大爱的触屏翻屏功能呀。。。*
- 【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
- 再换个版本： *【macport 里的， ARM 版本的M 版本的】* ：试一下可以触屏翻屏吗？活宝妹大爱的功能呀。。。。没有这个功能，活宝妹真想哭了。。。 *【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】* 这个版本活宝妹比较喜欢，没有第一个 29.1 的怪异中文字体、有 sr-speedbar 里 timer 的【BUG：】，活宝妹可以再改一遍；但是有了ARM M 版本的，活宝妹先前大爱的【触屏翻屏】功能，狠好用；没有怪异的中文字体；C-; 是好用的。【就用这个版本的】 *【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】*
  
[[./pic/readme_20230911_143430.png]]
- Emacs: ARM M 版本里， csharp-mode 里总是有个环形引用： elpa 里我弄的 csharp-mode 的版本太多了，用了相比古老的 csharp-mode 和 tree-sitter 结合起来的，可以用了
- ARM M 版本Emacs, 里，被他们把 emacs 到VSC 的自动跳转拦住了。zsh 终端可以找到 code. 但是 emacs 里找不到code. *【找到原因是】：活宝妹昨天下午折腾那块板，结果一个什么狔版本的 texinfo 库，把 emacs 里不能正常 parse 系统的 path 变量了。。去掉就都好了。。。* 真坑人呀。。。。 *【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】*
- *【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】*
- 【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
- 现在版本的 Emacs 其它 bug 都扫除了，再改最后一个最简单的： sr-speedbar 里 timer 的【BUG：】。改完就清空了。搜索 librime 里如何引用词库，以后就可以动态更新活宝妹魔改过的词库了！！！【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
- 【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹就是一定要、一定会嫁给活宝妹的亲爱的表哥！！！爱表哥，爱生活！！！】
** ARM M-series: Rime 自己建不出来。。
- trying to build Squirral ARM M version (have to self-build for ARM M versions, but not successful yet, was able to build librime dylib, but not for Squirral yet);
- For me, it seems like when I install in ARM arche term, boost library somewhere somehow is missing.......
- Still install Squirral input method app for x86_64 version;
- install Emacs 29.1 universal version;
- build librime dynamic library for emacs pyim for ARM archi; https://github.com/merrickluo/liberime Mac ARM 适用, 可用。需要明白它是怎么连接词库的
- make Emacs 29.1 universal work for pyim with ARM librime dynamic library work.
- 因为Macbook 下的 Rime 输入法支持arm 的构建已经好了，我应该可以 *【构建出 arm64-arch 的Rime 动态库给 emacs 用】：可是现在还建不出来*
- Rime 安装链接：https://github.com/rime/squirrel/blob/master/INSTALL.md 
- 把 emacs 升级为 arm64-arch
- 把 arm64-arch 的 emacs 版本pyim 配置好
- 把 appcode 重新安装 arm64-arch 版本，应该就可以与 arm64-arch 版本的 emacs 自由跳转了。而不必再是 X86_64 版本的。
- *【总结】* ：安装 arm64-arch 版本，是与自己笔记本硬件更好地配合提升效率。
- 但过程繁琐，仍然不能达到 *【亲爱的表哥的活宝妹，实时想要动态更改词库，实时想要更新动态库给 emacs 用的需求！】*
- 这系列更新包括：Rime-arm64 版本安装与自己构建、emacs 删除与重新安装与 pyim 配置， appcode 的删除与再安装。前两个应用都可能出问题。。。若真出问题，就把自己的配置摧毁掉了。。。
- 我其实只要去解决：【亲爱的表哥的活宝妹，怎么才能手动构建 Rime 的动态词库？】只要我能手动构建更新后词库的动态库，我就满足了自己的使用需求。
  - 【难点：】这是别人输入法的精华。虽然只改了一个最小的脚本错误，但是正如全中文网没人会告诉你别人输入法的精华、没有贴子真正会涉及这些精华（细节的构建步骤，只有一个几年前的老贴子不 work: https://hackmd.io/@PhahTaigi/r1tlmy0cV），所有的都是去抓现成的缺省版本的。就当自己想要了解和深入中文输入法更进一步。留这个兴趣点在这里。改天有时间、有机会再看。细节上，就是Rime 的 boost 库可能也没有能够找全，该生成的文件没能全部生成。也可能是因为现在系统 arm64-arch 硬件与 x86_64 Rime 的库不匹配？可是我试 x86_64 之前，先试过本地 arm64-arch 版本，也没能生成。改天再看。（可以参考 Rime 提供的不完整步骤：https://github.com/rime/librime/blob/master/README-mac.md 和一个用户M1 的步骤： https://www.bilibili.com/read/cv9664366/. 另Rime M1 手动构建步骤说明：https://github.com/rime/squirrel/blob/master/INSTALL.md）
- 折腾了大半个下午，仍然同先前一样构建不出来，只是感觉比前几个月似乎理解得更深刻一点儿。说明今天下午大改前的考虑是对的，看起来狠容易的动态库构建，没人自己手动构建，只有亲爱的表哥的活宝妹突发奇想，觉得可能可以有效更新词库。实际因素可能还有狠多。这个思路暂时放下。
- 【重点：上次我的 emacs 升级，为什么我不能把它直接升级到 arm 版本来着？那个 csharp-mode 的循环问题不是早解决了？！！！可以再试下？ NO, not yet.】
- 现和使用的 x86_64 版本，当初是为了安装 pyim 吗？如果是这样，我不应该再有任何的变化，就意味着我无法从 appcode 中打开当前 emacs 的 buffer 文件（因为 emacs 的 x86_64 版本限制了其正常找到 appcode 所依赖的 arm64-arch 环境？这个可以试着找下是否有解决方案）；
- 而如果 pyim 可以 workwith arm 版本，我就可以安装 arm64-arch 版本，可能就可以从 appcode 中打开当前 emacs 的 buffer 文件了。
- 我要再试一遍？【现在还不能够试，在我b还不能够构建和安装出 rime 系统输入法的 arm64-arch 版本动态库之前（这个输入法，现系统所安装的是 x86_64 版本的），我安装 arm64-arch 版本的 emacs ，我的pyim 将不可以用（找不到对应版本的 rime 动态库），因为我构建不出 arm64-arch 版本的 pyim 所依赖的动态库。所以将现在的 emacs 委屈成了 x86_64 版本的，也因为这样，我的 emacs 无法正常加载 arm 版本的 appcode 所依赖的动态库，所以无法从 emacs 中直接在 appcode 中打开当前 buffer 文件。】
- 可以 walk-around 的解决办法是：安装 x86-64 版本的 appcode. 【在自己能够想方设法构建出 arm 版本的 rime 动态库之前，先用这个版本，可以满足自已的基本跳转需求】

[[./pic/readme_20230225_132052.png]]
- 有试过， boost 的步骤基本能够完成，但是构建第三方库时的 cmake 与 xcode-clang++ 还有很多 arm 相关的问题待解。 
- 那么我现在有个迫切需要：就是能够自己构建 arm64-arch 版本的 rime 输入法( 至少是能够编译出它的动态库吧？！！！)：现在找到的参考如下： 
- 现在 emacs 使用的是 28.2 X86_64 版本。我 *【想要动态手动更新Rime 五笔第三方库】* 。可是我忘记当初几个月之前，我是怎么添加这个动态库给 emacs 使用的了。会找一找。也可能再尝试能否构建出 arm 版本的第三方库。
- 有个教程，这里也简要记一下过程，免得自己总忘记：大致过程：
- 把Rime 的重新部署好的动态库，复制到 emacs 的Rime 第三方适配库 librime 特定目录下
- emacs 的Rime 第三方适配库 librime 下，生成Macbook 系统可用的用户第三方库
- 再配置 emacs 什么的就可以了。加个截图：【爱表哥，爱生活！！！任何时候，亲爱的表哥的活宝妹，就是一定要嫁给亲爱的表哥！！爱表哥，爱生活！！！】

[[./pic/readme_20230718_111929.png]]

- https://www.bilibili.com/read/cv9664366?from=search
- 但是按照上面的步骤，目前理解消化不够，安装不好。注意，这里用到的 MacOS 下在的库是： https://github.com/rime/squirrel 但是我仍然构建不出那个动态库
- 如些发现，原来，所谓 rime macOS 下的输入法构建，原来是 MacOS 下的平台应用，正是我可以学习的地方。终于是半只脚往输入法的坑里踏：
- https://www.logcg.com/archives/2078.html. 这些都可以成为日后自己学习和开发的参考 

- emacs 27.1 for emacs-rime input methods. one bug to be fixed. 

[[./pic/readme_20230214_134351.png]]
- this affect me access to current terminal, needs to be fixed later.
- after having updated swift-mode, color-theme for swift mode is much better now. 
** configue pyim wubi input method emacs-rime, works like a charm!
- 现在最大的缺点是：我无法使用自已魔改过的个性化字库，姓名住圵等等，活宝妹，亲爱的表哥，等等。但其它也算是基本清单了，再不折腾它了。花了太多的时间在这个上面。所以现在输入法还算是基本清单的。
- 两套：系统的，与 emacs 里自带的。目前的中英文转换只使用一个探针，过多会存在过灵的总是，某些情况下被禁用中文，就会更麻烦，不如它没有那么灵。爱亲爱的表哥，活宝妹一定要嫁的亲爱的表哥！！！
- 它具备以空格来区分中英文输入法的功能，但不能与中文下半角配合使用。也就是，它具备了我现在所使用过的 sis 下的自动中英文之间以一个空格为单位自动切换，但我无法使用中文下半角标点。
- 它除了使用了系统输入法的字库，其它所有好用的配置一个也不能用（我只能拦截一个最常用的半角，仍然是不方便的），现在只是可以选詞了而已，却不能使用其它中文下输入英文标点符号等 
- 我中文下使用英语标点：主要是 org-mode 打头的 -*. 等，它可以检测到，自动化到，还是方便的
** invalid time specification: sr-speedbar on MacOS
- I don't like this bug, and I belive I do NOT really using any timer for auto-refresh in my speedbar. So I ended up by disabling the (speedbar-edit-file() func, which is frequently bug trigered) setting timer part from /Applications/Emacs.app/Contents/Resources/lisp/speedbar.el.gz, and recompile the file. The bug was gone. And I could deal with csharp-mode's fontify bug. 
- newer debugging infos, concernibg about sr-speedbar.el file. Have NOT been able to trace down for today. 

[[./pic/readme_20230209_135039.png]]
- 好像是macOS系统常常存在的 bug,两年了关了又开，开了再关......
- https://github.com/remacs/remacs/issues/845
- get cmake work later, not urgent though.Complete
- babel org-mode so I don't have to copy from specific babeled source org-mode files in order for chinese characters to work. 
- Installed my emacs of version 28.1. But there is a bug of any verison emacs > 27.1, and I am NOT able to find a installable emacs 27.1 version any more. 
- 不同电脑架构上可能因为架构的不同，可以可能可以有某些优化.又照一个单做了一遍，似乎没有出错. https://goykhman.ca/gene/blog/2022/2022-04-10-emacs-28.1-on-m1.html
- 但是我没有没能加入那个补丁包.暂时没能想好怎么加入那个补丁包. （ *todo： 改天可以尝试再把这个补丁包加进去* ）
- 因为构建是在原有现有的 mac 28.1.1版本上构建的.所以改动什么，或是不曾改变，又或者改不了不影响明显功能都是无从知晓的，但是它最后的两个步骤的验证都是成功的，应该还是构建成功了吧？
  
[[./pic/readme_20230208_142554.png]]
- 今天又尝试安装Xcode之后再构建一遍，但是没有成功.可能本身参考有些年代，另外自己还完全不通这个部分，所以暂时放一放.改天有机会可以再回来研究一下，错在哪里，我如何才可能构建出自己的版本. 

[[./pic/readme_20230208_102317.png]]
- 上面又成为一个需要改的东西： 就是系统下如何从剪贴板自动生成写入文件 org-mode M-s
- 然后看见这里说可以自己构建一个，连Xcode也没有安装，就跑去构建了，当然不成功。这段时间太忙，XCode要的空间太大了，暂时还不想。等改天有机会的时候倒是可以一试的
  - https://stuff-things.net/2020/12/28/building-emacs-27-dot-1-on-macos-big-sur/
- added key-bindings for opening from VSCode/Android Studio of current emacs buffer. 
  - VSC Emacs can locate to each othr to correct row and col. 
  - Android Studio could open current emacs buffer. but not to the row nor col. 
- I liked recently configued Visual studio 2019 one-dark-pro theme, want to configue it for emacs, but ended up with any permission denied, renaming emacs initiating bug. reverted back for daily use, and may look into that bug for later reference. 
- will reconfigure one-dark-pro theme later.  
- fixed legency java-mode highlighing issue which I did not fix for years. Has been able to treat java-mode as java-mode Instead of using it as csharp-mode. Can not separate java-mode snippets from csharp-mode's.  
** BUG statement and partial fix
- in java-mode, the code style I expected is as followed:
#+BEGIN_SRC java
class node {
    int v ;
    public node() {
        if (a > 0) // I don't want { } blocks when I have only one line statement inside blocks
     // a = 17;    // before fix:
            a = 17;   // now it can auto-indent
        b = 20;
        while (true)  // same auto indents here
            j++;
    }
}
class dklfjdj {|} // <<==== current un-auto-expanded version, bug right now for java-mode
class dklfjdj { 
    | // <<==== expected feature: once I typed '{', '}' will be autopaired(it does), but also auto-expand and cursor moves and indents directly to where I expect
}
#+END_SRC
- if while if while one line statement autoindent without {} fixed today for java-mode, but for kotlin-mode, this bug consists, make coders/programmers nuts.
#+BEGIN_SRC java
fun getStringLength(obj: Any): Int? {
    if (obj is String)
    return obj.length  // <<<<===== BUG: need to fix auto-indent here for if else while etc without {} 

    if (obj is String) {
        return obj.length
    }
    // 在离开类型检测分支后，`obj` 仍然是 `Any` 类型
    return null
}
fun dslfkj { // kotlin-mode, unlike java-mode, this feature works charming
    val a = 1720 
}
#+END_SRC
        - The {|} can NOT auto-expand still bugs me a lot, I don't want to switch back to java-mode yet unless bug fixed and it auto-pands.
        - java minor bug: Debugger entered--Lisp error: (void-function company-clear-completion-rules): this bug I will look into it recently, and expect it to be fixed so I could switch java-mode from csharp-mode as soon as possible.
- *csharp-mode* has been the one that works perfectly for these two features, {} auto expand, also if while one line statement autoindent without {}, so I used csharp-mode as java mode.
* References
- https://github.com/redguardtoo/emacs.d

* windows 10 下面的 toggle-input-method 不 work: 想要绑定到一个方便使用的銉上面，另外 posframe （＋ point 1）只想加上下，不想加左右。
- 有个想要打开文件时，不能C-a 到根目录的 bug: 
- 激活中文必须 M-x:pyim-activate; 切换成英文可以 either M-x:pyim-deactivate 或者是 C-\\
- 再激活中文又必须是 M-x:pyim-activate
- 需要一个简单的键绑定，帮助自己方便地切换到中文：而不是每次都得M-x:pyim-activate 太麻烦，易输入错误 
  
[[./pic/readme_20230226_130117.png]]
